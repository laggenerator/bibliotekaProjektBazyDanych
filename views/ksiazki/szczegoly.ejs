<div class="ksiazka-szczegoly-container">
    <div class="ksiazka-header">
        <div class="ksiazka-obraz-container">
            <img src="<%= ksiazka.img_link %>" alt="Okładka: <%= ksiazka.tytul %>" 
                 class="ksiazka-duzy-obraz" 
                 onerror="this.src='/assets/okladki/placeholder.webp'">
        </div>
        
        <div class="ksiazka-info">
            <h1 class="ksiazka-tytul"><%= ksiazka.tytul %></h1>
            
            <div class="ksiazka-autor">
                <span class="label">
                <% if (Array.isArray(ksiazka.autor)) { %>
                    Autorzy:
                <% } else { %>
                    Autor:
                <% } %>
            </span>
            <span class="value">
                <% if (Array.isArray(ksiazka.autor)) { %>
                    <% ksiazka.autor.forEach(function(autor, index) { %>
                        <a href="/autorzy/<%= encodeURIComponent(autor) %>" class="autor-link">
                            <%= autor %>
                        </a>
                        <% if (index < ksiazka.autor.length - 1) { %>, <% } %>
                    <% }); %>
                <% } else { %>
                    <a href="/autorzy/<%= encodeURIComponent(autor) %>" class="autor-link">
                        <%= ksiazka.autor %>
                    </a>
                <% } %>
            </span>
            </div>

            <div class="ksiazka-details-grid">
                <div class="detail-item">
                    <span class="label">ISBN:</span>
                    <span class="value"><%= ksiazka.isbn %></span>
                </div>
                
                <div class="detail-item">
                    <span class="label">Rok wydania:</span>
                    <span class="value"><%= ksiazka.rok_wydania %></span>
                </div>
                
                <div class="detail-item">
                    <span class="label">Ilość stron:</span>
                    <span class="value"><%= ksiazka.ilosc_stron %> stron</span>
                </div>
                
                <div class="detail-item">
                    <span class="label">Kategorie:</span>
                    <span class="value"><%= ksiazka.kategorie || 'Brak kategorii' %></span>
                </div>
            </div>

            <div class="dostepnosc-stats">
                <div class="stat-dostepne">
                    <span class="stat-number"><%= dostepneKopie.length %></span>
                    <span class="stat-label">dostępnych kopii</span>
                </div>
                <div class="stat-lacznie">
                    <span class="stat-number"><%= kopie.length %></span>
                    <span class="stat-label">łącznie w bibliotece</span>
                </div>
            </div>

            <div class="ksiazka-actions">
                <% if (dostepneKopie.length > 0) { %>
                    <button class="btn btn-primary btn-large">Rezerwuj książkę</button>
                <% } else { %>
                    <button class="btn btn-secondary btn-large" disabled>Brak dostępnych kopii</button>
                <% } %>
            </div>
        </div>
    </div>

    <div class="kopie-section">
        <h2>Kopie w bibliotece</h2>
        
        <div class="kopie-lista">
            <% kopie.forEach(function(kopia, index) { %>
                <div class="kopia-item <%= kopia.dostepna ? 'dostepna' : 'niedostepna' %>">
                    <div class="kopia-info">
                        <div class="kopia-numer">
                            <span class="numer">Kopia #<%= index + 1 %></span>
                            <span class="status <%= kopia.dostepna ? 'status-dostepna' : 'status-niedostepna' %>">
                                <%= kopia.dostepna ? 'Dostępna' : 'Wypożyczona' %>
                            </span>
                        </div>
                        
                        <div class="kopia-id">
                            <span class="label">ID książki:</span>
                            <span class="value"><%= kopia.id %></span>
                        </div>
                    </div>
                    
                    <div class="kopia-akcje">
                        <% if (kopia.dostepna) { %>
                            <button class="btn btn-sm btn-primary">Rezerwuj tę kopię</button>
                        <% } else { %>
                            <button class="btn btn-sm btn-secondary" disabled>Niedostępna</button>
                        <% } %>
                    </div>
                </div>
            <% }); %>
        </div>
    </div>
</div>